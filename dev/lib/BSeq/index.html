<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bethe-Slapter-type equation solver · ElectronGas.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://numericalEFT.github.io/ElectronGas.jl/lib/BSeq/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ElectronGas.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/fock/">Fock diagram of free electrons</a></li><li><a class="tocitem" href="../../manual/polarization_3D/">Polarization of free electron</a></li><li><a class="tocitem" href="../../manual/polarization_2D/">Polarization of free electron in two dimensions</a></li><li><a class="tocitem" href="../../manual/ladder_3D/">Ladder (Particle-particle bubble) of free electrons</a></li><li><a class="tocitem" href="../../manual/polarization_approx/">Polarization Approximation</a></li><li><a class="tocitem" href="../../manual/legendreinteraction/">Legendre Decomposition of Interaction</a></li><li><a class="tocitem" href="../../manual/G_plus_Moroni/">Analytic Expression of <span>$G_{+}$</span> extracted from DMC</a></li><li><a class="tocitem" href="../../manual/quasiparticle/">Quasiparticle properties of electon gas</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../convention/">Convention</a></li><li><a class="tocitem" href="../parameter/">Parameter</a></li><li><a class="tocitem" href="../selfenergy/">Self Energy</a></li><li><a class="tocitem" href="../polarization/">Polarization</a></li><li><a class="tocitem" href="../interaction/">Interaction</a></li><li><a class="tocitem" href="../legendreinteraction/">Legendre Decomposed Interaction</a></li><li><a class="tocitem" href="../twopoint/">Two-point correlators</a></li><li class="is-active"><a class="tocitem" href>Bethe-Slapter-type equation solver</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>Bethe-Slapter-type equation solver</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bethe-Slapter-type equation solver</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/numericalEFT/ElectronGas.jl/blob/master/docs/src/lib/BSeq.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Bethe-Slapter-type-equation-solver"><a class="docs-heading-anchor" href="#Bethe-Slapter-type-equation-solver">Bethe-Slapter-type equation solver</a><a id="Bethe-Slapter-type-equation-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Bethe-Slapter-type-equation-solver" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="ElectronGas.BSeq" href="#ElectronGas.BSeq"><code>ElectronGas.BSeq</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Bethe-Slapter-type equation solver and the application to Cooper-pair linear response approach. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/ElectronGas.jl/blob/495633d7b87739bcfa2fb41de08ef4097f78a4a0/src/BSeq.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ElectronGas.BSeq.BSeq_solver-Tuple{Any, GreenFunc.MeshArrays.MeshArray, Any, Any, Vector{CompositeGrids.CompositeG.Composite}, Any}" href="#ElectronGas.BSeq.BSeq_solver-Tuple{Any, GreenFunc.MeshArrays.MeshArray, Any, Any, Vector{CompositeGrids.CompositeG.Composite}, Any}"><code>ElectronGas.BSeq.BSeq_solver</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function BSeq_solver(param, G2::GreenFunc.MeshArray, kernel, kernel_ins, qgrids::Vector{CompositeGrid.Composite},
    Euv; Ntherm=120, rtol=1e-10, α=0.7, source::Union{Nothing,GreenFunc.MeshArray}=nothing,
    source_ins::GreenFunc.MeshArray=GreenFunc.MeshArray([1], G2.mesh[2]; dtype=Float64, data=ones(1, G2.mesh[2].size))
)</code></pre><p>Bethe-Slapter equation solver by self-consistent iterations.</p><p class="math-container">\[    R(\omega_n, k) = \eta(\omega_n, k) - \frac{1}{\beta} \sum_m \frac{d^dp}{(2\pi)^d} \Gamma(\omega_n,k;\omega_m,p) G^{(2)}(\omega_m,p)R(\omega_m,p) ,\]</p><p>where <span>$\eta(\omega_n, k)$</span> is the sourced term, <span>$\Gamma(k,\omega_n;p,\omega_m)$</span> is the particle-particle four-point vertex  with zero incoming momentum and frequency, and <span>$G^{(2)}(p,\omega_m)$</span> is the product of two single-particle Green&#39;s function.</p><p><strong>Arguments</strong></p><ul><li><code>param</code>: parameters of ElectronGas.</li><li><code>G2</code>: product of two single-particle Green&#39;s function (::GreenFunc.MeshArray).</li><li><code>kernel</code>: dynamical kernel of the Legendre decomposed effective interaction.</li><li><code>kernel_ins</code>: instant part of the the Legendre decomposed effective interaction.</li><li><code>qgrids</code>: momentum grid of kernel (::Vector{CompositeGrid.Composite}).</li><li><code>Euv</code>: the UV energy scale of the spectral density. </li><li><code>Ntherm</code>: thermalization step. By defalut, <code>Ntherm=120</code>.</li><li><code>rtol</code>: tolerance absolute error. By defalut, <code>rtol=1e-10</code>.</li><li><code>α</code>: mixing parameter in the self-consistent iteration. By default, <code>α=0.7</code>.</li><li><code>source</code>: dynamical part of sourced term in imaginary-time space. By default, <code>source=nothing</code>.</li><li><code>source_ins</code>: instant part of sourced term. By default, <code>source_ins=1</code>.</li></ul><p><strong>Return</strong></p><ul><li>Inverse of low-energy linear response <code>1/R₀</code> (<span>$R_0=R(\omega_0, k_F)$</span>)</li><li>Bethe-Slapter amplitude <code>F</code> in imaginary-frequency space</li></ul><p class="math-container">\[    F(\omega_m, p) = G^{(2)}(\omega_m,p)R(\omega_m,p)\]</p><ul><li>dynamical part of <code>R</code> in imaginary-time space</li><li>instant part of <code>R</code> in imaginary-time space</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/ElectronGas.jl/blob/495633d7b87739bcfa2fb41de08ef4097f78a4a0/src/BSeq.jl#L192-L226">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ElectronGas.BSeq.G02wrapped-NTuple{4, Any}" href="#ElectronGas.BSeq.G02wrapped-NTuple{4, Any}"><code>ElectronGas.BSeq.G02wrapped</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function G02wrapped(Euv, rtol, sgrid, param)</code></pre><p>Returns the product of two bare single-particle Green&#39;s function.</p><p class="math-container">\[   G_0^{(2)}(\omega_n, k) = 1/(\omega_n^2+\omega^2)\]</p><p>where <span>$\omega= k^2/(2m)-\mu$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/ElectronGas.jl/blob/495633d7b87739bcfa2fb41de08ef4097f78a4a0/src/BSeq.jl#L138-L146">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ElectronGas.BSeq.G2wrapped-Tuple{GreenFunc.MeshArrays.MeshArray, GreenFunc.MeshArrays.MeshArray, Any}" href="#ElectronGas.BSeq.G2wrapped-Tuple{GreenFunc.MeshArrays.MeshArray, GreenFunc.MeshArrays.MeshArray, Any}"><code>ElectronGas.BSeq.G2wrapped</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function G2wrapped(Σ::GreenFunc.MeshArray, Σ_ins::GreenFunc.MeshArray, param)</code></pre><p>Returns the product of two single-particle Green&#39;s function from given dynamical and instant parts of self-energy (<code>Σ</code> and <code>Σ_ins</code>).</p><p class="math-container">\[   G_0^{(2)}(\omega_n, k) = 1/\left([\omega_n - \mathrm{Im} \Sigma(\omega_n, k)]^2+
   [\omega+ \mathrm{Re} \Sigma(\omega_n, k) - \Sigma_{\mathrm{shift}}]^2\right)\]</p><p>where <span>$\omega= k^2/(2m)-\mu$</span> and <span>$\Sigma_{\mathrm{shift}}=\mathrm{Re} \Sigma(\omega_0, k_F)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/ElectronGas.jl/blob/495633d7b87739bcfa2fb41de08ef4097f78a4a0/src/BSeq.jl#L161-L170">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ElectronGas.BSeq.calcF!-NTuple{4, GreenFunc.MeshArrays.MeshArray}" href="#ElectronGas.BSeq.calcF!-NTuple{4, GreenFunc.MeshArrays.MeshArray}"><code>ElectronGas.BSeq.calcF!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calcF!(F::GreenFunc.MeshArray, R::GreenFunc.MeshArray, R_ins::GreenFunc.MeshArray, G2::GreenFunc.MeshArray)</code></pre><p>Calculation of the Bethe-Slapter amplitude <code>F</code> from the product of single-particle Green&#39;s function <code>G2</code>  and the dynamical and instant parts of <code>R</code>, <code>R_ins</code>. Compute in frequency space to avoid \tau integration.</p><p class="math-container">\[    F(\omega_n, k) = G^{(2)}(\omega_n, k) [R(\omega_n, k)+R_{\mathrm{ins}}(k)]\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/ElectronGas.jl/blob/495633d7b87739bcfa2fb41de08ef4097f78a4a0/src/BSeq.jl#L50-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ElectronGas.BSeq.calcR!-Tuple{GreenFunc.MeshArrays.MeshArray, GreenFunc.MeshArrays.MeshArray, GreenFunc.MeshArrays.MeshArray, Union{Nothing, GreenFunc.MeshArrays.MeshArray}, Any, Any, Vector{CompositeGrids.CompositeG.Composite}}" href="#ElectronGas.BSeq.calcR!-Tuple{GreenFunc.MeshArrays.MeshArray, GreenFunc.MeshArrays.MeshArray, GreenFunc.MeshArrays.MeshArray, Union{Nothing, GreenFunc.MeshArrays.MeshArray}, Any, Any, Vector{CompositeGrids.CompositeG.Composite}}"><code>ElectronGas.BSeq.calcR!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calcR!(F::GreenFunc.MeshArray, R::GreenFunc.MeshArray, R_ins::GreenFunc.MeshArray,
    source::Union{Nothing,GreenFunc.MeshArray}, kernel, kernel_ins, qgrids::Vector{CompositeGrid.Composite})</code></pre><p>Calculate <span>$kR(\tau, k)$</span> in three dimensions by given <code>pF(\tau, p)</code> and <code>kernel</code>.  Compute in imaginary time space to aviod frequency convolution.</p><p class="math-container">\[    kR(\tau, k) = k\eta(\tau, k) - \int \frac{dp}{4\pi^2} H(\tau,k,p) pF(\tau,p),\]</p><p>where <span>$H(\tau,k,p)\equiv kp W(\tau,k,p)$</span> is the helper function of interaction (see <a href="https://numericaleft.github.io/ElectronGas.jl/dev/manual/legendreinteraction/">Legendre Decomposition of Interaction</a>)  and the kernel argument. The dynamical <code>source</code> <span>$k\eta(\tau, k)$</span> will be added if it is given as <code>GreenFunc.MeshArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/ElectronGas.jl/blob/495633d7b87739bcfa2fb41de08ef4097f78a4a0/src/BSeq.jl#L67-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ElectronGas.BSeq.calcR_2d!-Tuple{GreenFunc.MeshArrays.MeshArray, GreenFunc.MeshArrays.MeshArray, GreenFunc.MeshArrays.MeshArray, Union{Nothing, GreenFunc.MeshArrays.MeshArray}, Any, Any, Vector{CompositeGrids.CompositeG.Composite}}" href="#ElectronGas.BSeq.calcR_2d!-Tuple{GreenFunc.MeshArrays.MeshArray, GreenFunc.MeshArrays.MeshArray, GreenFunc.MeshArrays.MeshArray, Union{Nothing, GreenFunc.MeshArrays.MeshArray}, Any, Any, Vector{CompositeGrids.CompositeG.Composite}}"><code>ElectronGas.BSeq.calcR_2d!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function calcR_2d!(F::GreenFunc.MeshArray, R::GreenFunc.MeshArray, R_ins::GreenFunc.MeshArray,  
    source::Union{Nothing,GreenFunc.MeshArray}, kernel, kernel_ins, qgrids::Vector{CompositeGrid.Composite})</code></pre><p>Calculate <span>$kR(\tau, k)$</span> in two dimensions by given <code>pF(p)</code> and <code>kernel</code> Compute in imaginary time space to aviod frequency convolution.</p><p class="math-container">\[    kR(\tau, k) = k\eta(\tau, k) - \int \frac{pdp}{4\pi^2} W(\tau,k,p) pF(\tau,p),\]</p><p>where <span>$W$</span> is the interaction and the kernel argument. The dynamical <code>source</code> <span>$k\eta(\tau, k)$</span> will be added if it is given as <code>GreenFunc.MeshArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/ElectronGas.jl/blob/495633d7b87739bcfa2fb41de08ef4097f78a4a0/src/BSeq.jl#L104-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ElectronGas.BSeq.initFR-NTuple{4, Any}" href="#ElectronGas.BSeq.initFR-NTuple{4, Any}"><code>ElectronGas.BSeq.initFR</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function initFR(Euv, rtol, sgrid, param)</code></pre><p>Initalize the Bethe-Slapter amplitude <code>F</code> in imaginary-frequency space and <code>R ≡ F(GG)⁻¹</code> in imaginary-time space.</p><p><strong>Arguments:</strong></p><ul><li><code>Euv</code>: the UV energy scale of the spectral density. parameter for DLR grids.</li><li><code>rtol</code>: tolerance absolute error. parameter for DLR grids.</li><li><code>sgrid</code>: momentum grid of F and R</li><li><code>param</code>: parameters of ElectronGas.</li></ul><p><strong>Return</strong></p><ul><li><span>$F(\omega_n, k)=0$</span> as a <code>GreenFunc.MeshArray</code></li><li>the dynamical part of <code>R</code> in the imaginary-time space as a <code>GreenFunc.MeshArray</code>. In the imaginary-frequency space,</li></ul><p class="math-container">\[    R(\omega_n, k) =  \frac{1}{\Omega_c^2+e^2}\left(1- \frac{2\omega_n^2}{\omega_n^2+\Omega_c^2} \right)\]</p><p>where <span>$e=k^2/(2m)-\mu$</span> and <span>$\Omega_c =0.01$</span>.</p><ul><li>the instant part of <code>R</code> as a <code>GreenFunc.MeshArray</code>, <span>$R_{\mathrm{ins}}(k)=0$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/ElectronGas.jl/blob/495633d7b87739bcfa2fb41de08ef4097f78a4a0/src/BSeq.jl#L12-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ElectronGas.BSeq.linearResponse-Tuple{Any, Int64}" href="#ElectronGas.BSeq.linearResponse-Tuple{Any, Int64}"><code>ElectronGas.BSeq.linearResponse</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function linearResponse(param, channel::Int; Euv=100 * param.EF, rtol=1e-10,
    maxK=10param.kF, minK=1e-7param.kF, Nk=8, order=8, sigmatype=:none, int_type=:rpa, α=0.7)</code></pre><p>Implmentation of Cooper-pair linear response approach.</p><p><strong>Arguments:</strong></p><ul><li><code>param</code>: parameters of ElectronGas.</li><li><code>channel::Int</code>: orbital angular channel (0: s-wave, 1: p-wave, ...)</li><li><code>Euv</code>: the UV energy scale of the spectral density. By default, <code>Euv=100EF</code>.</li><li><code>rtol</code>: tolerance absolute error. By defalut, <code>rtol=1e-10</code>.</li><li><code>maxK</code>: maximum momentum of kgrid and qgrids. By default, <code>maxK=10kF</code>.</li><li><code>minK</code>: minimum interval of panel kgrid and qgrids. By default, <code>minK=1e-7kF</code>.</li><li><code>Nk</code>: number of grid points of panel kgrid and qgrids. By defalut, <code>Nk=8</code>.</li><li><code>order</code>: number of grid points of subgrid of kgrid and qgrids. By defalut, <code>order=8</code>.</li><li><code>sigmatype</code>: type of fermionic self-energy. (no self-energy :none, G0W0 approximation :g0w0)</li><li><code>int_type</code>: type of effective interaction. By default, <code>int_type=:rpa</code>.</li><li><code>α</code>: mixing parameter in the self-consistent iteration. By default, <code>α=0.7</code>.</li></ul><p><strong>Return:</strong></p><ul><li>Inverse of low-energy linear response <code>1/R₀</code> (<span>$R_0=R(\omega_0, k_F)$</span>)</li><li>Linear response <code>R(ωₙ, k)</code>, which is calculated by the Bethe-Slapter-type equation</li></ul><p class="math-container">\[    R(\omega_n, k) = 1 - \frac{1}{\beta} \sum_m \int \frac{d^dp}{(2\pi)^d} \Gamma(\omega_n,k;\omega_m,p) G^{(2)}(\omega_m,p)R(\omega_m,p)\]</p><p>where <span>$1$</span> is the default sourced term, <span>$\Gamma(k,\omega_n;p,\omega_m)$</span> is the particle-particle four-point vertex  with zero incoming momentum and frequency, and <span>$G^{(2)}(p,\omega_m)$</span> is the product of two single-particle Green&#39;s function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/numericalEFT/ElectronGas.jl/blob/495633d7b87739bcfa2fb41de08ef4097f78a4a0/src/BSeq.jl#L321-L348">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../twopoint/">« Two-point correlators</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 16 June 2023 21:18">Friday 16 June 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
