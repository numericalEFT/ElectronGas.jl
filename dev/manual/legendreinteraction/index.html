<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Legendre Decomposition of Interaction · ElectronGas.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://numericalEFT.github.io/ElectronGas.jl/manual/legendreinteraction/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ElectronGas.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../fock/">Fock diagram of free electrons</a></li><li><a class="tocitem" href="../polarization/">Polarization of free electron</a></li><li><a class="tocitem" href="../polarization_2D/">Polarization of free electron in two dimensions</a></li><li class="is-active"><a class="tocitem" href>Legendre Decomposition of Interaction</a><ul class="internal"><li><a class="tocitem" href="#Why-decompose?"><span>Why decompose?</span></a></li><li><a class="tocitem" href="#How?"><span>How?</span></a></li><li><a class="tocitem" href="#Helper-function"><span>Helper function</span></a></li><li><a class="tocitem" href="#Three-dimensions"><span>Three dimensions</span></a></li><li><a class="tocitem" href="#Two-dimensions"><span>Two dimensions</span></a></li></ul></li><li><a class="tocitem" href="../G_plus_Moroni/">Analytic Expression of <span>$G_{+}$</span> extracted from DMC</a></li><li><a class="tocitem" href="../quasiparticle/">Quasiparticle properties of electon gas</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Legendre Decomposition of Interaction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Legendre Decomposition of Interaction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/numericalEFT/ElectronGas.jl/blob/master/docs/src/manual/legendreinteraction.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Legendre-Decomposition-of-Interaction"><a class="docs-heading-anchor" href="#Legendre-Decomposition-of-Interaction">Legendre Decomposition of Interaction</a><a id="Legendre-Decomposition-of-Interaction-1"></a><a class="docs-heading-anchor-permalink" href="#Legendre-Decomposition-of-Interaction" title="Permalink"></a></h1><h2 id="Why-decompose?"><a class="docs-heading-anchor" href="#Why-decompose?">Why decompose?</a><a id="Why-decompose?-1"></a><a class="docs-heading-anchor-permalink" href="#Why-decompose?" title="Permalink"></a></h2><p>In many cases we need to calculate integrals of the following form:</p><p class="math-container">\[   \begin{aligned}
\Delta(\vec{k}) = \int \frac{d^dp}{(2\pi)^d} W(|\vec{k}-\vec{p}|) F(\vec{p}),
\tag{1}
   \end{aligned}\]</p><p>where only momentum dependency is of our concern. In such cases we assume that the interaction depends only on the magnitude of the momentum difference, and the other part of the integrand has some sort of space symmetry.</p><p>Two typical cases are the calculation of self-energy and gap-function equation. In the case of self-energy, the other part of the integrand depends only on the magnitude of the momentum, thus we can integrate out the angular dependence to simplify the calculation. In the case of gap-function equation, we do not know priorly the symmetry of anomalous correlator, but we can always decompose the interaction and anomalous correlator into angular momentum channels. In that sense, the self-energy case is actually a special case where we only care about s-channel.</p><h2 id="How?"><a class="docs-heading-anchor" href="#How?">How?</a><a id="How?-1"></a><a class="docs-heading-anchor-permalink" href="#How?" title="Permalink"></a></h2><p>We first express the interaction in Legendre polynomials for <span>$d (\geq 3)$</span> dimensions:</p><p class="math-container">\[   \begin{aligned}
W(|\vec{k}-\vec{p}|)&amp;=\sum_{\ell=0}^{\infty}\frac{N(d,\ell)}{2} w_l(k, p) P_{l}(\hat{kp}) \,,\\
w_{\ell}(k, p) &amp;= \int_{-1}^{1}d\chi P_l(\chi) W(\sqrt{k^2+p^2-2kp\chi}) \,, \\
   \end{aligned}\]</p><p>where </p><p class="math-container">\[N(d, \ell)=\frac{2 \ell+d-2}{\ell}\left(
\begin{array}{c}
\ell+d-3 \\
\ell-1
\end{array}\right)\]</p><p>denotes the number of linearly independent Legendre polynomials of degree <span>$\ell$</span> in <span>$d$</span> dimensions (<span>$d\geq 3$</span>). The Legendre polynomials of a scalar product of unit vectors can be expanded using the addition theorem for spherical harmonics</p><p class="math-container">\[P_{\ell}(\hat{k p})=\frac{\Omega_{d}}{N(d,\ell)} \sum_{m=1}^{N(d,\ell)} Y_{\ell m}(\hat{k}) Y_{\ell m}^{*}(\hat{p})\,,\]</p><p>where <span>$\Omega_{d}=(2\pi)^{\frac d 2}/\Gamma(\frac d 2)$</span> is the solid angle in <span>$d$</span> dimensions. The spherical harmonics are orthonormal as </p><p class="math-container">\[\int {\rm d}\hat k Y_{\ell m}(\hat k)  Y^*_{\ell^\prime m^\prime}(\hat k)  = \delta_{\ell \ell^\prime} \delta_{mm^\prime} \,.\]</p><p>Hence, the <span>$W(|\vec{k}-\vec{p}|)$</span> function can expressed further on as</p><p class="math-container">\[W(|\vec{k}-\vec{p}|)=\frac{\Omega_d}{2} \sum_{\ell m}  w_l(k, p) Y_{lm}(\hat{k})Y_{lm}^{*}(\hat{p}).\]</p><p>The other part of the integrand could also be decomposed as</p><p class="math-container">\[   \begin{aligned}   
   F(\vec p) &amp;= \sum_{\ell m} f_{\ell m}(p) Y_{\ell m}(\hat p)\,, \\
f_{lm}(p) &amp;= \int d\hat{k}Y^*_{lm}(\hat{p})F(\vec{p})
   \end{aligned}\]</p><p>Projecting Eq.(1), on the spherical harmonic <span>$Y_{\ell m}(\hat k)$</span>, we have</p><p class="math-container">\[\begin{aligned}
\sum_{\ell m} \Delta_{\ell m }(k)Y_{\ell m}(\hat k) &amp;= \frac{\Omega_d}{2} \int \frac{{\rm d}\vec p}{(2\pi)^d} \sum_{\ell m} w_{\ell}(k,p)   Y_{\ell m}(\hat{k}) Y_{\ell m}^{*}(\hat{p} ) \sum_{\ell^\prime m^\prime}f_{\ell^\prime m^\prime}(p) Y_{\ell^\prime m^\prime}(\hat p)  \\
&amp;=\frac{\Omega_d}{2} \sum_{\ell m} \int \frac{p^{d-1}dp}{(2\pi)^d}  w_{\ell}(k,p,\tau) f_{\ell m}(p, \tau) Y_{\ell m}(\hat k) \,,
\end{aligned}\]</p><p>which leads to the decoupled equations with channels.</p><p>For gap-function equation, we have</p><p class="math-container">\[   \begin{aligned}
\Delta_l(k) = \frac{\Omega_d}{2}  \int \frac{p^{d-1} {\rm d}p}{(2\pi)^d} w_l(k, p) f_l(p) \,.
   \end{aligned}\]</p><p>For <span>$GW$</span> self-energy symmertric with <span>$\hat k$</span>, we have</p><p class="math-container">\[   \begin{aligned}
\Sigma(k) = \frac{\Omega_d}{2}  \int \frac{p^{d-1} {\rm d}p}{(2\pi)^d} w_0(k, p) G(p).
   \end{aligned}\]</p><h2 id="Helper-function"><a class="docs-heading-anchor" href="#Helper-function">Helper function</a><a id="Helper-function-1"></a><a class="docs-heading-anchor-permalink" href="#Helper-function" title="Permalink"></a></h2><p>We can do the decomposition with helper function:</p><p class="math-container">\[\begin{aligned}
H_n(y) = \int_{0}^{y} z^n W(z)dz.
\end{aligned}\]</p><p>Then</p><p class="math-container">\[\begin{aligned}
\int_{|k-p|}^{k+p} z^n W(z)dz = H_n(k+p)-H_n(|k-p|)= \delta H_n(k, p).
\end{aligned}\]</p><p>Changing variables in Eq.(1) to <span>$z^2=k^2+p^2-2kp\chi$</span>, we obatin </p><p class="math-container">\[w_{\ell}(k, p)=\frac{1}{k p} \int_{|k-p|}^{k+p} z d z P_{\ell}\left(\frac{k^{2}+p^{2}-z^{2}}{2 k p}\right) W(z)\]</p><p>Since <span>$P_{\ell}(x)$</span> is a polynomial in <span>$x$</span>, for any <span>$k$</span>,<span>$p$</span>, and integer <span>$\ell$</span>, <span>$w_l$</span> can be expressed as the combination of helper functions.</p><p>For electron gas, the <span>$W$</span> function contains two terms, bare interaction <span>$V$</span> and generic <span>$W(q,\tau)$</span>. We only tabulated helper functions for the second term. Helper functions for the first term <span>$h_n$</span> can be done analytically.</p><h2 id="Three-dimensions"><a class="docs-heading-anchor" href="#Three-dimensions">Three dimensions</a><a id="Three-dimensions-1"></a><a class="docs-heading-anchor-permalink" href="#Three-dimensions" title="Permalink"></a></h2><p>For 3D, <span>$N(3,\ell)=2\ell +1$</span>, and <span>$Y_{\ell m}$</span> is the standard sphereical harmonic function. The <span>$GW$</span> self energy is</p><p class="math-container">\[   \begin{aligned}
\Sigma(k) =   \int \frac{p^2 {\rm d}p}{4\pi^2} w_0(k, p) G(p) \,.
   \end{aligned}\]</p><p>For 3D electron gas with bare interaction <span>$V=\frac{4\pi e^2}{q^2} \delta(\tau)\, \left( V(r)=\frac{e^2}{r} \right)$</span>, the helper functions for the first term have</p><p class="math-container">\[\delta h_{1}(k, p)=4 \pi e^{2} \ln \frac{k+p}{|k-p|}, \quad \delta h_{3}(k, p)=4 \pi e^{2}[2 k p], \quad \delta h_{5}(k, p)=4 \pi e^{2}\left[2 k p\left(k^{2}+p^{2}\right)\right] .\]</p><p>3D Yukawa interaction has</p><p class="math-container">\[\begin{aligned}
V(r) &amp;= \frac{e^2}{r}e^{-mr}, \quad V(q)=\frac{4\pi e^2}{q^2+m^2} ,\\
\delta h_{1}(k, p)&amp;=2 \pi e^{2} \ln\left[\frac{(k+p)^2+m^2}{(k-p)^2+m^2}\right], \\
\delta h_{3}(k, p)&amp;=4 \pi e^{2} \left[2kp - \frac{m^2}{2} \ln \frac{(k+p)^2+m^2}{(k-p)^2+m^2} \right], \\
\delta h_{5}(k, p)&amp;=4 \pi e^{2}\left[2 k p\left(k^2+p^2 -m^2\right) +\frac{m^4}{2}\ln \frac{(k+p)^2+m^2}{(k-p)^2+m^2} \right].
\end{aligned}\]</p><p><span>$w_l$</span> can be expressed as</p><p class="math-container">\[   \begin{aligned}
w_0(k,p) &amp;= \frac{1}{kp} \delta H_1(k, p), \\
w_1(k,p) &amp;= \frac{1}{2{(kp)}^2} {[(k^2+p^2)\delta H_1(k, p)-\delta H_3(k, p)]}, \\
w_2(k,p) &amp;= \frac{1}{{(2kp)}^3}
{\{[3{(k^2+p^2)}^2-4k^2p^2]\delta H_1(k, p)-6(k^2+p^2)\delta H_3(k, p)+3\delta H_5(k, p)\} }.
   \end{aligned}\]</p><h2 id="Two-dimensions"><a class="docs-heading-anchor" href="#Two-dimensions">Two dimensions</a><a id="Two-dimensions-1"></a><a class="docs-heading-anchor-permalink" href="#Two-dimensions" title="Permalink"></a></h2><p>For 2D, the interaction is expressed as Fourier series:</p><p class="math-container">\[   \begin{aligned}
W(|\vec{k}-\vec{p}|)&amp;=\frac{w_0}{2\pi} + \sum_{\ell=1}^{\infty} w_l(k, p) \frac{\cos[\ell(\theta_{\hat k} - \theta_{\hat p})]}{\pi} \,,\\
w_{\ell}(k, p) &amp;= \int_{0}^{2\pi} d\theta \cos(\ell \theta) W(\sqrt{k^2+p^2-2kp\cos \theta}) \,. \\
   \end{aligned}\]</p><p>Projecting Eq.(1), we have</p><p class="math-container">\[\begin{aligned}
&amp;\frac{\Delta_{0}(k)}{2\pi}+ \sum_{\ell=1} \Delta_{\ell}(k) \frac{\cos(\ell \theta_{\hat k})}{\pi} +\overline{\Delta}_{\ell}(k) \frac{\sin(\ell \theta_{\hat k})}{\pi} \\
=&amp; \int \frac{{\rm d}\vec p}{(2\pi)^2} \frac{w_{0}(k,p)}{2\pi} \frac{f_0(p)}{2\pi} + \sum_{\ell=1} w_{\ell}(k,p) \frac{\cos(\ell \theta_{\hat k})\cos(\ell \theta_{\hat p}) - \sin(\ell \theta_{\hat k})\sin(\ell \theta_{\hat p}) }{\pi}    \sum_{\ell^\prime=1} \left[ f_{\ell^\prime}(p) \frac{\cos(\ell^\prime \theta_{\hat p})}{\pi}  + \overline{f}_{\ell^\prime}(p) \frac{\sin(\ell^\prime \theta_{\hat p})}{\pi} \right] \\
=&amp; \int \frac{pdp}{(2\pi)^2} w_{0}(k,p) \frac{f_0(p)}{2\pi} + \sum_{\ell=1} w_{\ell}(k,p) \left[f_{\ell}(p) \frac{\cos(\ell \theta_{\hat k})}{\pi} +\overline{f}_{\ell}(p) \frac{\sin(\ell \theta_{\hat k})}{\pi} \right] \,,
\end{aligned}\]</p><p>where <span>$\Delta_{\ell}(k) =\int_{0}^{2\pi} d\theta \cos(\ell \theta) \Delta(\vec k)$</span>. It leads to the decoupled equations with <span>$\ell$</span> channels. The <span>$GW$</span> self energy corresponding to <span>$\ell=0$</span> is</p><p class="math-container">\[\Sigma(k) =   \int \frac{p {\rm d}p}{(2\pi)^2} w_0(k, p) G(p) \,,\]</p><p>and for gap function we have</p><p class="math-container">\[\Delta_l(k) = \int \frac{p {\rm d}p}{(2\pi)^2} w_l(k, p) f_l(p) \,.\]</p><p>Since <span>$\sin \theta$</span> is lack in 2D integration, the helper functions are complicated and useless in 2D. Here, we directly calculate  <span>$w_{\ell}(k,p)$</span> integration with a CompositeGrid (range <span>$[0, \pi]$</span>, Log-dense at <span>$0$</span>).</p><ul><li><p>standard 2D coulomb potential (3D coulomb interaction restricted in 2D): <span>$V=\frac{2\pi e^2}{q} \delta(\tau)\, \left( V(r)=\frac{e^2}{r} \right)$</span> has the same real-space form as in 3D electron gas.</p></li><li><p>REAL 2D coulomb potential (obey Gauss&#39;s law in 2D): <span>$V=\frac{4\pi e^2}{q^2} \delta(\tau)\,\left(V(r)=-\ln \frac{r}{L}\right)$</span> has the same momentum-space form as in 3D electron gas.</p></li><li><p>2D Yukawa interaction has</p></li></ul><p class="math-container">\[\begin{aligned}
V(r)&amp;=\frac{e^2}{r} e^{-mr} ,\\
V(q)&amp;=\int {\rm d}^2\vec r V(r) e^{i\vec q\cdot \vec r} \\
    &amp; = \int r dr \frac{e^2}{r} e^{-mr} \int_0^{2\pi} d\theta e^{iqr\cos \theta} \\
    &amp; = \int dr e^2 e^{-mr} 2\pi J_0(qr) \\
    &amp; = \frac{2\pi e^2}{\sqrt{q^2+m^2}} \,,
\end{aligned}\]</p><p><strong>Reference</strong>:</p><ol><li>Christopher Frye and Costas J. Efthimiou, Spherical Harmonics in <span>$p$</span> Dimensions, arXiv 1205.3548</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../polarization_2D/">« Polarization of free electron in two dimensions</a><a class="docs-footer-nextpage" href="../G_plus_Moroni/">Analytic Expression of <span>$G_{+}$</span> extracted from DMC »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Sunday 10 April 2022 12:30">Sunday 10 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
